@{
    ViewData["Title"] = "Home Page";
}

<h1>Ricerca Prenotazioni per Codice Fiscale</h1>
<input type="text" id="codiceFiscale" placeholder="Inserisci Codice Fiscale">
<button id="searchButton">Cerca</button>
<div id="results"></div>

<h1>Contatore Prenotazioni con Pensione Completa</h1>
<button id="countButton">Conta</button>
<div id="countResult"></div>

@section scripts {
  
    <script>
        $(document).ready(function () {
            $('#searchButton').click(function () {
                var codiceFiscale = $('#codiceFiscale').val();
                $.ajax({
                    url: `/api/PrenotazioniApi/SearchByCodiceFiscale`,
                    type: 'GET',
                    data: { codiceFiscale: codiceFiscale },
                    success: function (data) {
                        if (data.message) {
                            $('#results').text(data.message);
                        } else {
                            $('#results').empty();
                            $.each(data, function (index, prenotazione) {
                                $('#results').append(`<p>Prenotazione ID: ${prenotazione.id}, Tipo Soggiorno: ${prenotazione.tipoSoggiorno}</p>`);
                            });
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error:', error);
                    }
                });
            });

            $('#countButton').click(function () {
                $.ajax({
                    url: `/api/PrenotazioniApi/CountPensioneCompleta`,
                    type: 'GET',
                    success: function (data) {
                        $('#countResult').text(`Numero di prenotazioni con pensione completa: ${data.count}`);
                        if (data.clienti && data.clienti.length > 0) {
                            $('#countResult').append('<ul>');
                            $.each(data.clienti, function (index, cliente) {
                                $('#countResult').append(`<li>${cliente.nome} ${cliente.cognome} (Codice Fiscale: ${cliente.codiceFiscale})</li>`);
                            });
                            $('#countResult').append('</ul>');
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error:', error);
                    }
                });
            });
        });
    </script>
}
